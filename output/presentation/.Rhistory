arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(20,20), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(10,5), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(5,2), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(2,0), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(2,-5), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(2,-1), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(10,0), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(20,0), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(0,0.5), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(0,0.25), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=c(0,0.35), line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=0.35, line=-1, cex=1.2, col="black")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
png("Fig6_specifc management_metric.png", res=300, height=9, width=18, units="in", pointsize=20, "transparent")
par(oma=c(3,5,1,0))
# -------    Load data and model   -----------
moddat <- readRDS(paste(workspacewd, "model dataset_0c.rds", sep="/"))
mod <- readRDS(paste(workspacewd, "models_0c_blme.rds", sep="/"))
# -------   Produce plotting dataset predictions   ---------
plotdat <- list()
for (i in 1:length(mod)) {
# dataset to predict over is the same as the original dataset
pred <- predict(mod[[i]], type="response", re.form=NA)
pred.CI <- easyPredCI(mod[[i]], moddat[[i]])
fits <- data.frame(pred, pred.CI, metric=moddat[[i]]$new.metric, mgmtvar=paste(mgmtvars[i], moddat[[i]][,mgmtvars[i]]), mgmt.type=i)
unique.fits <- unique(fits)
plotdat[[i]] <- aggregate(unique.fits[,c("pred","lwr","upr")], by=list(mgmtvar=unique.fits$mgmtvar, mgmt.type=unique.fits$mgmt.type, metric=unique.fits$metric), mean)
}
names(plotdat) <- mgmtvars
fig3c <- do.call(rbind, plotdat[4:9])
### ---- Fig 3c: Specific management interventions plot - METRIC ----
par(mar=c(5,3,3,0))
plotfinal <- fig3c
maxmetric <- levels(do.call(rbind, plotdat)$metric)
n <- length(maxmetric)
set.seed(2)
pch <- data.frame(metric=maxmetric, pch=rep(c(21,22,23),length.out=n), col=sample(c("blue","darkmagenta","orange"), n))
pch
plotfinal <- merge(plotfinal,pch, by="metric")
plotfinal <- plotfinal[order(plotfinal$mgmtvar,plotfinal$metric),]
plotfinal$rowid <- 1:nrow(plotfinal)
xloc.mgmtvars <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), mean)$x
xloc.divide <- aggregate(plotfinal$rowid, list(plotfinal$mgmtvar), max)$x + 0.5
xloc.divide <- xloc.divide[-length(xloc.divide)]
x <- c(min(plotfinal$rowid):max(plotfinal$rowid))
plot(plotfinal$pred~x, ylim=c(0,1), xlim=c(min(plotfinal$rowid),max(plotfinal$rowid)), pch=plotfinal$pch, bg=as.character(plotfinal$col), cex=1.8, xaxt="n", xlab="", ylab="", las=1, bty="n", col.axis="white", fg="white", col="white")
abline(v=xloc.divide, lty=3, lwd=1.5, col="white")
text(xloc.mgmtvars, par("usr")[3]-0.05, srt = 0, pos=1, xpd = TRUE, labels=c("mowing \napplied","mowing \nreduced", "grazing \napplied", "grazing \nreduced","fertiliser/\npesticides \nreduced","nest \nprotection \napplied","predator \ncontrol \napplied","water \napplied", "water \nreduced"), col="white")
arrows(x, plotfinal$pred, x, plotfinal$lwr, angle=90, length=0.05, col="white")
arrows(x, plotfinal$pred, x, plotfinal$upr, angle=90, length=0.05, col="white")
abline(h=0.05, lty=3, lwd=2, col="white")
legend("topleft", legend=pch$metric, pch=pch$pch, pt.bg=as.character(pch$col), pt.cex=1.2, bty="n", xpd=TRUE, inset=c(0.01,-0.2), text.col="white", col="white")
mtext("Intervention", side=1, outer=TRUE, at=0.35, line=-1, cex=1.2, col="white")
mtext("Predicted probability of success \n (significant positive impact)", side=2, outer=TRUE, cex=1.2, line=1.5, col="white")
dev.off()
